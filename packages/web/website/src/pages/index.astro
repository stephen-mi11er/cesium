---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Cesium Demo" >
	<main>
		<astro-cesium data-access-token={import.meta.env.PUBLIC_CESIUM_ACCESS_TOKEN}>
			<div id="cesiumContainer">
			</div>
		</astro-cesium>
	</main>
</Layout>

<script is:inline>
	class AstroCesium extends HTMLElement {
		 constructor() {
			super();

			// Your access token can be found at: https://ion.cesium.com/tokens.
			// This is the default access token from your ion account
			Cesium.Ion.defaultAccessToken = this.dataset.accessToken;

			// Initialize the Cesium Viewer in the HTML element with the `cesiumContainer` ID.
			const viewer = new Cesium.Viewer('cesiumContainer', {
				terrain: Cesium.Terrain.fromWorldTerrain(),
			});

			// Fly the camera to San Francisco at the given longitude, latitude, and height.
			viewer.camera.flyTo({
				destination: Cesium.Cartesian3.fromDegrees(-122.4175, 37.655, 400),
				orientation: {
					heading: Cesium.Math.toRadians(0.0),
					pitch: Cesium.Math.toRadians(-15.0),
				}
			});

			async function load() {
				const buildingTileset = await Cesium.createOsmBuildingsAsync();
				viewer.scene.primitives.add(buildingTileset);
			}

			load();
		}
	}

	customElements.define('astro-cesium', AstroCesium);
</script>


<style>
	main {
		margin: auto;
		padding: 1rem;
		width: 800px;
		max-width: calc(100% - 2rem);
		color: white;
		font-size: 20px;
		line-height: 1.6;
	}
</style>
